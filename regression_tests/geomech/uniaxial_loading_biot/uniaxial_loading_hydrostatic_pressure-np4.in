SIMULATION
  SIMULATION_TYPE GEOMECHANICS_SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE richards
    / 
    GEOMECHANICS_SUBSURFACE geomech
  / 
END

SUBSURFACE

GRID
  TYPE structured
  BOUNDS
    0.0 0.0 0.0 
    1.0 1.0 10.0 
  /
  NXYZ 1 1 10 
END

TIME
  FINAL_TIME 0.1 d
  INITIAL_TIMESTEP_SIZE 0.001 d
  MAXIMUM_TIMESTEP_SIZE 1.0 d
END

MATERIAL_PROPERTY soil1
  ID 1
  CHARACTERISTIC_CURVES default
  POROSITY 0.25
  TORTUOSITY 1.0
  PERMEABILITY
    PERM_ISO 1.000d-12
  /
END

OUTPUT
  TIMES  d 0.1
#  FORMAT TECPLOT POINT
#  FORMAT HDF5
END

CHARACTERISTIC_CURVES default
  SATURATION_FUNCTION VAN_GENUCHTEN
   ALPHA 0.0001
   M 0.5
   LIQUID_RESIDUAL_SATURATION 0.1
  / 
  PERMEABILITY_FUNCTION MUALEM_VG_LIQ
   M 0.5
   LIQUID_RESIDUAL_SATURATION 0.1
  / 
END

REGION all
  COORDINATES
    0.0 0.0 0.0 
    1.0 1.0 10.0 
  /
END

REGION bottom
  FACE BOTTOM
  COORDINATES
    0.0 0.0 0.0 
    1.0 1.0 0.0 
  /
END

REGION top
  FACE TOP
  COORDINATES
    0.0 0.0 10.0 
    1.0 1.0 0.0 
  /
END

FLOW_CONDITION initial
  DATUM 0.0 0.0 0.0
  TYPE
    PRESSURE hydrostatic
  /
    PRESSURE 500000.0
END

FLOW_CONDITION top_flow
  DATUM 0.0 0.0 0.0
  TYPE
    PRESSURE hydrostatic
  /
    PRESSURE 500000.0
END

INITIAL_CONDITION initial
  FLOW_CONDITION initial
  REGION all
END

BOUNDARY_CONDITION top
  FLOW_CONDITION top_flow
  REGION top
END

BOUNDARY_CONDITION bottom
  FLOW_CONDITION top_flow
  REGION bottom
END

STRATA
  REGION all
  MATERIAL soil1
END

END_SUBSURFACE

GEOMECHANICS

GEOMECHANICS_GRID
  TYPE unstructured geomech_dat/usg.mesh
  GRAVITY 0.0 0.0 0.0 
END

GEOMECHANICS_SUBSURFACE_COUPLING ONE_WAY_COUPLED
  MAPPING_FILE flow_geomech_mapping.dat
END

GEOMECHANICS_REGRESSION
  VARIABLES
    DISPLACEMENT_Z
    STRAIN_ZZ
    STRESS_ZZ
  /
  VERTICES
    5
    14
    23
    32
    41
    50
    59
    68
    77
    86
    95
    104
  /
END

GEOMECHANICS_TIME
  COUPLING_TIMESTEP_SIZE 0.1 d
END

GEOMECHANICS_REGION all_geomech
  FILE geomech_dat/all.vset
END

GEOMECHANICS_REGION north_geomech
  FILE geomech_dat/north.vset
END

GEOMECHANICS_REGION south_geomech
  FILE geomech_dat/south.vset
END

GEOMECHANICS_REGION east_geomech
  FILE geomech_dat/east.vset
END

GEOMECHANICS_REGION west_geomech
  FILE geomech_dat/west.vset
END

GEOMECHANICS_REGION top_geomech
  FILE geomech_dat/top.vset
END

GEOMECHANICS_REGION bottom_geomech
  FILE geomech_dat/bottom.vset
END

GEOMECHANICS_REGION top_boundary
  FILE geomech_dat/top_boundary.vset
END

GEOMECHANICS_REGION top_corner
  FILE geomech_dat/top_corner.vset
END

GEOMECHANICS_REGION top_internal
  FILE geomech_dat/top_internal.vset
END

GEOMECHANICS_CONDITION west_geomech
  TYPE
    DISPLACEMENT_X dirichlet
  END
    DISPLACEMENT_X 0.0
END

GEOMECHANICS_CONDITION east_geomech
  TYPE
    DISPLACEMENT_X dirichlet
  END
    DISPLACEMENT_X 0.0
END

GEOMECHANICS_CONDITION north_geomech
  TYPE
    DISPLACEMENT_Y dirichlet
  END
    DISPLACEMENT_Y 0.0
END

GEOMECHANICS_CONDITION bottom_geomech
  TYPE
    DISPLACEMENT_Z dirichlet
  END
    DISPLACEMENT_Z 0.0
END

GEOMECHANICS_CONDITION south_geomech
  TYPE
    DISPLACEMENT_Y dirichlet
  END
    DISPLACEMENT_Y 0.0
END

GEOMECHANICS_CONDITION top_corner_force
  TYPE
    FORCE_Z dirichlet
  END
    FORCE_Z -62500.0
END

GEOMECHANICS_CONDITION top_boundary_force
  TYPE
    FORCE_Z dirichlet
  END
    FORCE_Z -125000.0
END

GEOMECHANICS_CONDITION top_internal_force
  TYPE
    FORCE_Z dirichlet
  END
    FORCE_Z -250000.0
END

GEOMECHANICS_BOUNDARY_CONDITION bottom_geomech
  GEOMECHANICS_CONDITION bottom_geomech
  GEOMECHANICS_REGION bottom_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION east_geomech
  GEOMECHANICS_CONDITION east_geomech
  GEOMECHANICS_REGION east_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION west_geomech
  GEOMECHANICS_CONDITION west_geomech
  GEOMECHANICS_REGION west_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION north_geomech
  GEOMECHANICS_CONDITION north_geomech
  GEOMECHANICS_REGION north_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION south_geomech
  GEOMECHANICS_CONDITION south_geomech
  GEOMECHANICS_REGION south_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION top_corner_force
  GEOMECHANICS_CONDITION top_corner_force
  GEOMECHANICS_REGION top_corner
END

GEOMECHANICS_BOUNDARY_CONDITION top_boundary_force
  GEOMECHANICS_CONDITION top_boundary_force
  GEOMECHANICS_REGION top_boundary
END

GEOMECHANICS_BOUNDARY_CONDITION top_internal_force
  GEOMECHANICS_CONDITION top_internal_force
  GEOMECHANICS_REGION top_internal
END

GEOMECHANICS_STRATA
  GEOMECHANICS_REGION all_geomech
  GEOMECHANICS_MATERIAL soil1
END

GEOMECHANICS_OUTPUT
  TIMES  d 0.1
#  FORMAT TECPLOT POINT
#  FORMAT HDF5
END

GEOMECHANICS_MATERIAL_PROPERTY soil1
  ID 1
  ROCK_DENSITY 1000.0
  YOUNGS_MODULUS 1000000000.0
  POISSONS_RATIO 0.0
  BIOT_COEFFICIENT 1.0
  THERMAL_EXPANSION_COEFFICIENT 0.0
END

END_GEOMECHANICS
