SIMULATION
  SIMULATION_TYPE GEOMECHANICS_SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE richards
    / 
    GEOMECHANICS_SUBSURFACE geomech
  / 
END

SUBSURFACE

EOS WATER
  DENSITY LINEAR 990.0 101325 4.400d-10
  VISCOSITY CONSTANT 0.00066
END

GRID
  TYPE structured
  BOUNDS
    0.0 0.0 0.0 
    1.0 1.0 100.0 
  /
  NXYZ 1 1 30 
  GRAVITY 0.0 0.0 0.0 
END

TIMESTEPPER FLOW
  MAX_TS_CUTS 200
END

TIME
  FINAL_TIME 0.4 s
  INITIAL_TIMESTEP_SIZE 0.1 s
  MAXIMUM_TIMESTEP_SIZE 1.0 s
END

MATERIAL_PROPERTY soil1
  ID 1
  CHARACTERISTIC_CURVES default
  POROSITY 0.5
  TORTUOSITY 1.0
  PERMEABILITY
    PERM_ISO 1.000d-12
  /
  GEOMECHANICS_SUBSURFACE_PROPS
    COMPRESSIBILITY_FUNCTION LINEAR_MODEL
  /
END

NEWTON_SOLVER flow
  RTOL 1.000d-08
  STOL 1.000d-30
  ITOL 1.000d-08
  ITOL_UPDATE 0.0001
END

skip
OUTPUT
  TIMES  s 0.35 0.7 1.05 1.4 1.75 2.1 2.45 2.8 3.15 3.5
  FORMAT TECPLOT POINT
  VARIABLES 
    POROSITY
    LIQUID_PRESSURE
    PERMEABILITY
  /
END
noskip
CHARACTERISTIC_CURVES default
  SATURATION_FUNCTION VAN_GENUCHTEN
   ALPHA 0.0001
   M 0.5
   LIQUID_RESIDUAL_SATURATION 0.1
  / 
  PERMEABILITY_FUNCTION MUALEM_VG_LIQ
   M 0.5
   LIQUID_RESIDUAL_SATURATION 0.1
  / 
END

REGION all
  COORDINATES
    0.0 0.0 0.0 
    1.0 1.0 100.0 
  /
END

REGION bottom
  FACE BOTTOM
  COORDINATES
    0.0 0.0 0.0 
    1.0 1.0 0.0 
  /
END

REGION top
  FACE TOP
  COORDINATES
    0.0 0.0 100.0 
    1.0 1.0 100.0 
  /
END

FLOW_CONDITION initial
  DATUM 0.0 0.0 100.0
  TYPE
    PRESSURE dirichlet
  /
    PRESSURE 101325.0
END

FLOW_CONDITION top_flow
  TYPE
    PRESSURE dirichlet
  /
    PRESSURE 101325.0
END

FLOW_CONDITION bottom_flow
  TYPE
    FLUX neumann
  /
    FLUX 0.0
END

INITIAL_CONDITION initial
  FLOW_CONDITION initial
  REGION all
END

BOUNDARY_CONDITION top
  FLOW_CONDITION top_flow
  REGION top
END

BOUNDARY_CONDITION bottom
  FLOW_CONDITION bottom_flow
  REGION bottom
END

STRATA
  REGION all
  MATERIAL soil1
END

END_SUBSURFACE

GEOMECHANICS

GEOMECHANICS_GRID
  TYPE unstructured geomech_dat/usg.mesh
  GRAVITY 0.0 0.0 0.0 
END

GEOMECHANICS_SUBSURFACE_COUPLING TWO_WAY_COUPLED
  MAPPING_FILE flow_geomech_mapping.dat
END

GEOMECHANICS_REGRESSION
  VERTICES
    5
    14
    23
    32
    41
    50
    59
    68
    77
    86
    95
    104
    113
    122
    131
    140
    149
    158
    167
    176
    185
    194
    203
    212
    221
    230
    239
    248
    257
    266
    275
    284
  /
  VARIABLES
    DISPLACEMENT_Z
    STRAIN_ZZ
    STRESS_ZZ
  /
END

GEOMECHANICS_TIME
  COUPLING_TIMESTEP_SIZE 0.1 s
END

GEOMECHANICS_REGION all_geomech
  FILE geomech_dat/all.vset
END

GEOMECHANICS_REGION north_geomech
  FILE geomech_dat/north.vset
END

GEOMECHANICS_REGION south_geomech
  FILE geomech_dat/south.vset
END

GEOMECHANICS_REGION east_geomech
  FILE geomech_dat/east.vset
END

GEOMECHANICS_REGION west_geomech
  FILE geomech_dat/west.vset
END

GEOMECHANICS_REGION top_geomech
  FILE geomech_dat/top.vset
END

GEOMECHANICS_REGION bottom_geomech
  FILE geomech_dat/bottom.vset
END

GEOMECHANICS_REGION top_boundary
  FILE geomech_dat/top_boundary.vset
END

GEOMECHANICS_REGION top_corner
  FILE geomech_dat/top_corner.vset
END

GEOMECHANICS_REGION top_internal
  FILE geomech_dat/top_internal.vset
END

GEOMECHANICS_CONDITION west_geomech
  TYPE
    DISPLACEMENT_X dirichlet
  END
    DISPLACEMENT_X 0.0
END

GEOMECHANICS_CONDITION east_geomech
  TYPE
    DISPLACEMENT_X dirichlet
  END
    DISPLACEMENT_X 0.0
END

GEOMECHANICS_CONDITION north_geomech
  TYPE
    DISPLACEMENT_Y dirichlet
  END
    DISPLACEMENT_Y 0.0
END

GEOMECHANICS_CONDITION bottom_geomech
  TYPE
    DISPLACEMENT_Z dirichlet
  END
    DISPLACEMENT_Z 0.0
END

GEOMECHANICS_CONDITION south_geomech
  TYPE
    DISPLACEMENT_Y dirichlet
  END
    DISPLACEMENT_Y 0.0
END

GEOMECHANICS_CONDITION top_corner_force
  TYPE
    FORCE_Z dirichlet
  END
    FORCE_Z -68832.8125
END

GEOMECHANICS_CONDITION top_boundary_force
  TYPE
    FORCE_Z dirichlet
  END
    FORCE_Z -137665.625
END

GEOMECHANICS_CONDITION top_internal_force
  TYPE
    FORCE_Z dirichlet
  END
    FORCE_Z -275331.25
END

GEOMECHANICS_BOUNDARY_CONDITION bottom_geomech
  GEOMECHANICS_CONDITION bottom_geomech
  GEOMECHANICS_REGION bottom_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION east_geomech
  GEOMECHANICS_CONDITION east_geomech
  GEOMECHANICS_REGION east_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION west_geomech
  GEOMECHANICS_CONDITION west_geomech
  GEOMECHANICS_REGION west_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION north_geomech
  GEOMECHANICS_CONDITION north_geomech
  GEOMECHANICS_REGION north_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION south_geomech
  GEOMECHANICS_CONDITION south_geomech
  GEOMECHANICS_REGION south_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION top_corner_force
  GEOMECHANICS_CONDITION top_corner_force
  GEOMECHANICS_REGION top_corner
END

GEOMECHANICS_BOUNDARY_CONDITION top_boundary_force
  GEOMECHANICS_CONDITION top_boundary_force
  GEOMECHANICS_REGION top_boundary
END

GEOMECHANICS_BOUNDARY_CONDITION top_internal_force
  GEOMECHANICS_CONDITION top_internal_force
  GEOMECHANICS_REGION top_internal
END

GEOMECHANICS_STRATA
  GEOMECHANICS_REGION all_geomech
  GEOMECHANICS_MATERIAL soil1
END

skip
GEOMECHANICS_OUTPUT
  TIMES  s 0.35 0.7 1.05 1.4 1.75 2.1 2.45 2.8 3.15 3.5
  FORMAT TECPLOT POINT
  FORMAT HDF5
END
noskip

GEOMECHANICS_MATERIAL_PROPERTY soil1
  ID 1
  ROCK_DENSITY 2000.0
  YOUNGS_MODULUS 10000000000.0
  POISSONS_RATIO 0.0
  BIOT_COEFFICIENT 1.0
  THERMAL_EXPANSION_COEFFICIENT 0.0
END

END_GEOMECHANICS
